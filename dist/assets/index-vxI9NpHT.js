!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const e={monday_tuesday:[{cozinha:"A. Viihtube",banhBaixo:"Bixo Gaga",banhSuite:"Bixo Alexa",sala:"I. Ivan",lavabo:"I. Ivan"},{cozinha:"I. Ivan",banhBaixo:"A. Viihtube",banhSuite:"Bixo Gaga",sala:"Bixo Alexa",lavabo:"Bixo Alexa"},{cozinha:"Bixo Alexa",banhBaixo:"I. Ivan",banhSuite:"A. Viihtube",sala:"Bixo Gaga",lavabo:"Bixo Gaga"},{cozinha:"Bixo Gaga",banhBaixo:"Bixo Alexa",banhSuite:"I. Ivan",sala:"A. Viihtube",lavabo:"A. Viihtube"}],wednesday:[{cozinha:"Rita",banhBaixo:"LATAM",banhSuite:"Navala",sala:"Smigou",lavabo:"Smigou"},{cozinha:"Smigou",banhBaixo:"Rita",banhSuite:"LATAM",sala:"Navala",lavabo:"Navala"},{cozinha:"Navala",banhBaixo:"Smigou",banhSuite:"Rita",sala:"LATAM",lavabo:"LATAM"},{cozinha:"LATAM",banhBaixo:"Navala",banhSuite:"Smigou",sala:"Rita",lavabo:"Rita"}],thursday_friday:[{cozinha:"BBB",banhBaixo:"Madre",banhSuite:"Espalha",sala:"Leidi",lavabo:"Leidi"},{cozinha:"Leidi",banhBaixo:"BBB",banhSuite:"Madre",sala:"Espalha",lavabo:"Espalha"},{cozinha:"Espalha",banhBaixo:"Leidi",banhSuite:"BBB",sala:"Madre",lavabo:"Madre"},{cozinha:"Madre",banhBaixo:"Espalha",banhSuite:"Leidi",sala:"BBB",lavabo:"BBB"}]},a=[{label:"🍽️ Cozinha",key:"cozinha"},{label:"🚿 Banheiro de baixo",key:"banhBaixo"},{label:"🛁 Banheiro suíte",key:"banhSuite"},{label:"🛋️ Sala e corredor",key:"sala"},{label:"🚽 Lavabo",key:"lavabo"}],t=[{day:"Domingo",users:"Espalha Lixo e Rita",dayIndex:0},{day:"Segunda e Terça",users:"B. Gaga e B. Alexa",dayIndex:1},{day:"Terça-feira",users:"Latam e A. Viihtube",dayIndex:2},{day:"Quarta-feira",users:"Madre e Navala",dayIndex:3},{day:"Quinta-feira",users:"BBB e Smigou",dayIndex:4},{day:"Quinta e Sexta",users:"Leidi",dayIndex:5},{day:"Sábado",users:"I. Ivan",dayIndex:6}],n={referenceDate:new Date(2020,1,24),themeStorageKey:"escalas-tabajara-theme",darkModeClass:"dark-mode"},i="☀️",r="🌙",s="Alternar para modo escuro",o="Alternar para modo claro",l=e=>{if(!(e instanceof Date)||isNaN(e.getTime()))throw new Error("Data inválida fornecida para formatação");return e.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})},d=(e,a,t)=>{if(!(e instanceof Date)||isNaN(e.getTime())||!(a instanceof Date)||isNaN(a.getTime()))throw new Error("Datas inválidas fornecidas para cálculo de ciclos");let n=new Date(e);0===e.getDay()&&n.setDate(e.getDate()+1);const i=(e=>{if(!(e instanceof Date)||isNaN(e.getTime()))throw new Error("Data inválida fornecida para encontrar Segunda e Terça");const a=e.getDay(),t=0===a?-6:1-a,n=new Date(e);return n.setDate(e.getDate()+t),n.setHours(0,0,0,0),n})(n),r=Math.max(0,((e,a)=>{if(!(e instanceof Date)||isNaN(e.getTime())||!(a instanceof Date)||isNaN(a.getTime()))throw new Error("Datas inválidas fornecidas para cálculo de diferença");const t=e=>{const a=new Date(e),t=a.getDay(),n=0===t?-6:1-t;return a.setDate(a.getDate()+n),a.setHours(0,0,0,0),a},n=t(e),i=t(a);return Math.floor((n-i)/6048e5)})(i,a)),s=r%(t.monday_tuesday?.length||1),o=r%(t.wednesday?.length||1),l=r%(t.thursday_friday?.length||1),d=new Date(i);d.setDate(i.getDate()+2);const c=new Date(i);return c.setDate(i.getDate()+4),{monday_tuesdayDate:i,wednesdayDate:d,thursday_fridayDate:c,monday_tuesdayCycleIndex:s,wednesdayCycleIndex:o,thursday_fridayCycleIndex:l}},c=e=>{if(!(e instanceof Date)||isNaN(e.getTime()))return!1;const a=new Date;return e.getDate()===a.getDate()&&e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear()};class h{constructor(){this.cache=new Map,this.initializeCache()}initializeCache(){const e={scheduleContainer:"#cleaningSchedule",washingTableBody:".washing-schedule table tbody",themeToggle:"#themeToggle",themeIcon:"#themeIcon",footerYear:"#currentYear"};for(const[a,t]of Object.entries(e))this.cache.set(a,document.querySelector(t))}get(e){return this.cache.get(e)}set(e,a){this.cache.set(e,a)}validateEssentialElements(){return["scheduleContainer","themeToggle","themeIcon"].every((e=>null!==this.get(e)))}refresh(){this.cache.clear(),this.initializeCache()}}class u{static createElement(e,a={}){const t=document.createElement(e);if(a.classes&&t.classList.add(...a.classes),a.attributes)for(const[n,i]of Object.entries(a.attributes))t.setAttribute(n,i);return a.textContent&&(t.textContent=a.textContent),a.innerHTML&&(t.innerHTML=a.innerHTML),t}static clearElement(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}static safeAddClass(e,a){e&&void 0!==e.classList&&e.classList.add(a)}static safeRemoveClass(e,a){e&&void 0!==e.classList&&e.classList.remove(a)}static hasClass(e,a){return e&&e.classList&&e.classList.contains(a)}static safeSetAttribute(e,a,t){e&&"function"==typeof e.setAttribute&&e.setAttribute(a,t)}static safeSetText(e,a){e&&(e.textContent=a)}static safeAddEventListener(e,a,t,n={}){e&&"function"==typeof e.addEventListener&&e.addEventListener(a,t,n)}}class m{constructor(e){this.domCache=e,this.isDarkMode=!1,this.mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.init()}init(){this.loadSavedTheme(),this.setupEventListeners(),this.setupMediaQueryListener(),this.applyTheme(this.isDarkMode)}loadSavedTheme(){try{const e=localStorage.getItem(n.themeStorageKey);this.isDarkMode=null!==e?"dark"===e:this.mediaQuery.matches}catch(e){console.warn("Erro ao carregar tema do localStorage:",e),this.isDarkMode=this.mediaQuery.matches}}setupEventListeners(){const e=this.domCache.get("themeToggle");u.safeAddEventListener(e,"click",(()=>{this.toggleTheme()})),u.safeAddEventListener(e,"keydown",(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.toggleTheme())}))}setupMediaQueryListener(){this.mediaQuery.addEventListener("change",(e=>{null===localStorage.getItem(n.themeStorageKey)&&(this.isDarkMode=e.matches,this.applyTheme(this.isDarkMode))}))}toggleTheme(){this.isDarkMode=!this.isDarkMode,this.applyTheme(this.isDarkMode),this.saveTheme()}applyTheme(e){const a=document.body,t=this.domCache.get("themeIcon"),l=this.domCache.get("themeToggle");e?(u.safeAddClass(a,n.darkModeClass),u.safeSetText(t,r),u.safeSetAttribute(l,"aria-label",o)):(u.safeRemoveClass(a,n.darkModeClass),u.safeSetText(t,i),u.safeSetAttribute(l,"aria-label",s)),this.dispatchThemeChangeEvent(e)}saveTheme(){try{localStorage.setItem(n.themeStorageKey,this.isDarkMode?"dark":"light")}catch(e){console.warn("Erro ao salvar tema no localStorage:",e)}}dispatchThemeChangeEvent(e){const a=new CustomEvent("themeChanged",{detail:{isDarkMode:e}});document.dispatchEvent(a)}getCurrentTheme(){return this.isDarkMode?"dark":"light"}setTheme(e){"dark"===e||"light"===e?(this.isDarkMode="dark"===e,this.applyTheme(this.isDarkMode),this.saveTheme()):console.warn('Tema inválido. Use "dark" ou "light".')}resetTheme(){try{localStorage.removeItem(n.themeStorageKey),this.isDarkMode=this.mediaQuery.matches,this.applyTheme(this.isDarkMode)}catch(e){console.warn("Erro ao resetar tema:",e)}}destroy(){console.log("ThemeManager destruído")}}class g{constructor(e){this.domCache=e}renderSchedule(e,a){const t=this.domCache.get("scheduleContainer");if(t){this.clearElement(t);try{const n=this.createScheduleColumn("monday_tuesday","Segunda e Terça",a.monday_tuesday?.[e.monday_tuesdayCycleIndex],e.monday_tuesdayDate),i=this.createScheduleColumn("wednesday","Quarta-feira",a.wednesday?.[e.wednesdayCycleIndex],e.wednesdayDate),r=this.createScheduleColumn("thursday_friday","Quinta e Sexta",a.thursday_friday?.[e.thursday_fridayCycleIndex],e.thursday_fridayDate);t.appendChild(n),t.appendChild(i),t.appendChild(r),this.highlightCurrentDay(e)}catch(n){console.error("Erro ao renderizar escala:",n),this.renderErrorMessage(t)}}else console.error("Container da escala não encontrado")}createScheduleColumn(e,t,n,i){if(!n)return console.warn(`Escala não encontrada para ${t}`),this.createEmptyColumn(e,t,i);const r=this.createElement("div",{id:e,className:"column",attributes:{role:"region","aria-labelledby":`${e}-header`}}),s=this.createColumnHeader(e,t,i);r.appendChild(s);const o=this.createElement("div",{className:"rooms-list",attributes:{role:"list","aria-label":`Responsáveis pela limpeza de ${t}`}});return a.forEach((e=>{const a=this.createRoomElement(e,n);o.appendChild(a)})),r.appendChild(o),r}createColumnHeader(e,a,t){const n=this.createElement("header",{className:"column-header"}),i=this.createElement("h3",{textContent:a,id:`${e}-header`,className:"day-title"}),r=this.createElement("span",{textContent:l(t),className:"date-display",attributes:{"aria-label":`Data: ${l(t)}`}});return n.appendChild(i),n.appendChild(r),n}createRoomElement(e,a){const t=a[e.key]||"Não definido",n=this.createElement("div",{className:"room",attributes:{role:"listitem","aria-label":`${e.label}: ${t}`}}),i=this.createElement("span",{className:"room-name",textContent:e.label,attributes:{"aria-hidden":"true"}}),r=this.createElement("span",{className:"responsible",textContent:t,attributes:{title:`Responsável: ${t}`}});return n.appendChild(i),n.appendChild(r),n}createEmptyColumn(e,a,t){const n=this.createElement("div",{id:e,className:"column column-empty"}),i=this.createColumnHeader(e,a,t);n.appendChild(i);const r=this.createElement("p",{textContent:"Escala não disponível para este dia",className:"empty-message"});return n.appendChild(r),n}highlightCurrentDay(e){const a=(new Date).getDay();document.querySelectorAll(".column.current-day").forEach((e=>{e.classList.remove("current-day")})),1===a&&c(e.monday_tuesdayDate)?document.getElementById("monday_tuesday")?.classList.add("current-day"):3===a&&c(e.wednesdayDate)?document.getElementById("wednesday")?.classList.add("current-day"):5===a&&c(e.thursday_fridayDate)&&document.getElementById("thursday_friday")?.classList.add("current-day")}renderErrorMessage(e){this.clearElement(e);const a=this.createElement("div",{className:"error-message",innerHTML:'\n        <h3>❌ Erro ao carregar escala</h3>\n        <p>Não foi possível carregar a escala de limpeza. Tente recarregar a página.</p>\n        <button onclick="location.reload()" class="reload-button">\n          🔄 Recarregar página\n        </button>\n      '});e.appendChild(a)}updateCurrentDayHighlight(){document.querySelectorAll(".column.current-day").forEach((e=>{e.classList.remove("current-day")}))}createElement(e,a={}){const t=document.createElement(e);return a.id&&(t.id=a.id),a.className&&(t.className=a.className),a.textContent&&(t.textContent=a.textContent),a.innerHTML&&(t.innerHTML=a.innerHTML),a.attributes&&Object.entries(a.attributes).forEach((([e,a])=>{t.setAttribute(e,a)})),t}clearElement(e){if(e&&e.children)for(;e.firstChild;)e.removeChild(e.firstChild)}}class y{constructor(e){this.domCache=e}init(){this.highlightCurrentWashingDay(),this.setupAutoUpdate()}highlightCurrentWashingDay(){const e=this.domCache.get("washingTableBody");if(e)try{e.querySelectorAll("tr.current-day").forEach((e=>{u.safeRemoveClass(e,"current-day")}));const a=(new Date).getDay(),t=e.querySelectorAll("tr");t[a]&&(u.safeAddClass(t[a],"current-day"),u.safeSetAttribute(t[a],"aria-current","date"),t.forEach(((e,t)=>{t!==a&&e.removeAttribute("aria-current")})),this.scrollToCurrentDay(t[a]))}catch(a){console.error("Erro ao destacar dia atual na máquina de lavar:",a)}else console.warn("Tabela da máquina de lavar não encontrada")}scrollToCurrentDay(e){if(e)try{const a=e.getBoundingClientRect();a.top>=0&&a.bottom<=window.innerHeight||e.scrollIntoView({behavior:"smooth",block:"center"})}catch(a){console.warn("Erro ao rolar para o dia atual:",a)}}setupAutoUpdate(){setInterval((()=>{this.highlightCurrentWashingDay()}),6e4),u.safeAddEventListener(document,"visibilitychange",(()=>{document.hidden||this.highlightCurrentWashingDay()})),u.safeAddEventListener(window,"focus",(()=>{this.highlightCurrentWashingDay()}))}getTodayWashingInfo(){const e=(new Date).getDay();return t.find((a=>a.dayIndex===e))||null}getWashingInfoForDay(e){return e<0||e>6?(console.warn("Índice de dia inválido. Use 0-6 (domingo-sábado)"),null):t.find((a=>a.dayIndex===e))||null}getFullWeekSchedule(){return[...t]}isUserScheduledToday(e){const a=this.getTodayWashingInfo();return!!a&&a.users.toLowerCase().includes(e.toLowerCase())}findUserDays(e){return t.filter((a=>a.users.toLowerCase().includes(e.toLowerCase())))}renderWashingTable(){const e=this.domCache.get("washingTableBody");if(e)try{u.clearElement(e),t.forEach(((a,t)=>{const n=this.createWashingTableRow(a,t);e.appendChild(n)})),this.highlightCurrentWashingDay()}catch(a){console.error("Erro ao renderizar tabela da máquina de lavar:",a)}else console.error("Container da tabela da máquina de lavar não encontrado")}createWashingTableRow(e,a){const t=u.createElement("tr",{attributes:{"data-day-index":e.dayIndex.toString()}}),n=u.createElement("td",{textContent:e.day}),i=u.createElement("td",{textContent:e.users});return t.appendChild(n),t.appendChild(i),t}forceUpdate(){this.highlightCurrentWashingDay()}destroy(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null)}}class p{constructor(){this.domCache=null,this.themeManager=null,this.scheduleRenderer=null,this.washingManager=null,this.isInitialized=!1,this.initTime=Date.now(),this.errorCount=0,this.lastUpdate=null,this.lastError=null}async init(){try{if(console.log("🧹 Inicializando Sistema de Escalas da República Tabajara..."),this.domCache=new h,!this.domCache.validateEssentialElements())throw new Error("Elementos essenciais do DOM não encontrados");this.themeManager=new m(this.domCache),this.scheduleRenderer=new g(this.domCache),this.washingManager=new y(this.domCache),this.setupGlobalEventListeners(),await this.renderCleaningSchedule(),this.washingManager.init(),this.updateFooterYear(),this.isInitialized=!0,console.log("✅ Sistema inicializado com sucesso!")}catch(e){console.error("❌ Erro ao inicializar aplicação:",e),this.handleInitializationError(e)}}async renderCleaningSchedule(){try{const a=d(new Date,n.referenceDate,e);this.scheduleRenderer&&this.scheduleRenderer.renderSchedule(a,e)}catch(a){console.error("Erro ao renderizar escala de limpeza:",a),this.handleScheduleError(a)}}setupGlobalEventListeners(){document.addEventListener("visibilitychange",(()=>{!document.hidden&&this.isInitialized&&this.handleVisibilityChange()})),window.addEventListener("error",(e=>{this.handleGlobalError(e.error)})),window.addEventListener("unhandledrejection",(e=>{this.handleGlobalError(e.reason)}))}updateFooterYear(){const e=this.domCache?.get("footerYear");e&&(e.textContent=(new Date).getFullYear().toString())}handleVisibilityChange(){setTimeout((()=>{this.renderCleaningSchedule(),this.washingManager&&this.washingManager.highlightCurrentWashingDay()}),100)}handleInitializationError(e){const a=document.getElementById("cleaningSchedule");a&&(a.innerHTML=`\n        <div class="error-message">\n          <h3>❌ Erro de Inicialização</h3>\n          <p>Não foi possível inicializar o sistema de escalas.</p>\n          <p>Erro: ${e.message}</p>\n          <button onclick="location.reload()" class="reload-button">\n            🔄 Recarregar página\n          </button>\n        </div>\n      `)}handleScheduleError(e){console.error("Erro na escala:",e);const a=this.domCache?.get("scheduleContainer");a&&(a.innerHTML='\n        <div class="error-message">\n          <h3>❌ Erro na Escala</h3>\n          <p>Não foi possível carregar a escala de limpeza.</p>\n          <button onclick="location.reload()" class="reload-button">\n            🔄 Tentar novamente\n          </button>\n        </div>\n      ')}handleGlobalError(e){console.error("Erro global capturado:",e),this.errorCount++;const a=e instanceof Error?e.message:String(e);this.lastError&&this.lastError===a||(this.lastError=a)}getAppStats(){return{isInitialized:this.isInitialized,uptime:this.isInitialized?Date.now()-this.initTime:0,theme:this.themeManager?.getCurrentTheme()||"unknown",errors:this.errorCount||0,lastUpdate:this.lastUpdate||null}}forceUpdate(){this.isInitialized?(console.log("🔄 Forçando atualização..."),this.renderCleaningSchedule(),this.washingManager&&this.washingManager.highlightCurrentWashingDay(),this.updateFooterYear(),this.lastUpdate=new Date,console.log("✅ Atualização concluída")):console.warn("Aplicação não está inicializada")}destroy(){this.isInitialized=!1,console.log("🧹 Aplicação destruída")}}let b=null;const f=async()=>{try{b=new p,await b.init(),"undefined"!=typeof window&&(window.EscalasApp=b)}catch(e){console.error("Falha crítica na inicialização:",e)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",f):f();
//# sourceMappingURL=index-vxI9NpHT.js.map
